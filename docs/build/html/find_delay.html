

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>find_delay &mdash; find_delay 2.18 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/dark.css?v=70edf1c7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=aa0bd875"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
      <script src="_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="find_delays" href="find_delays.html" />
    <link rel="prev" title="find_delay documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #99cc00" >

          
          
          <a href="index.html" class="icon icon-home">
            find_delay
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">find_delay</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#find_delay.find_delay"><code class="docutils literal notranslate"><span class="pre">find_delay()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="find_delays.html">find_delays</a><ul>
<li class="toctree-l2"><a class="reference internal" href="find_delays.html#find_delay.find_delays"><code class="docutils literal notranslate"><span class="pre">find_delays()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="private_functions.html">Private functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._filter_frequencies"><code class="docutils literal notranslate"><span class="pre">_filter_frequencies()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._get_number_of_windows"><code class="docutils literal notranslate"><span class="pre">_get_number_of_windows()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._get_envelope"><code class="docutils literal notranslate"><span class="pre">_get_envelope()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._resample_window"><code class="docutils literal notranslate"><span class="pre">_resample_window()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._resample"><code class="docutils literal notranslate"><span class="pre">_resample()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._cross_correlation"><code class="docutils literal notranslate"><span class="pre">_cross_correlation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._convert_to_mono"><code class="docutils literal notranslate"><span class="pre">_convert_to_mono()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="private_functions.html#find_delay.private_functions._create_figure"><code class="docutils literal notranslate"><span class="pre">_create_figure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/delay_audio_files.html">Find the delay between two audio files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_audio_files.html#mono-stereo-files">Mono/stereo files</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_audio_files.html#audio-files-with-different-frequencies">Audio files with different frequencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_audio_files.html#compute-the-envelope-for-audio-files">Compute the envelope for audio files</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_audio_files.html#return-the-delay-in-seconds">Return the delay in seconds</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_audio_files.html#plot-the-delay">Plot the delay</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/delay_meg_misc.html">Find the delay of the audio on the MISC channel of an MEG recording</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_meg_misc.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/delay_meg_misc.html#procedure">Procedure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/delay_meg_misc.html#load-the-original-audio">Load the original audio</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/delay_meg_misc.html#isolate-the-audio-on-the-misc-channel">Isolate the audio on the MISC channel</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/delay_meg_misc.html#run-the-find-delay-function">Run the find_delay function</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/delay_meg_misc.html#correct-the-delay-and-save-the-events">Correct the delay and save the events</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="version_history.html">Version history</a><ul>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id1">2.18 (2025-06-29)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id2">2.17 (2025-04-10)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id3">2.16 (2025-03-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id4">2.15 (2025-01-23)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id5">2.14 (2024-12-17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id6">2.13 (2024-12-15)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id7">2.12 (2024-11-16)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id8">2.11 (2024-09-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id9">2.10 (2024-09-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id10">2.9 (2024-09-05)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id11">2.8 (2024-06-19)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id12">2.7 (2024-05-09)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id13">2.6 (2024-05-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id14">2.5 (2024-05-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id15">2.4 (2024-05-08)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id16">2.3 (2024-05-02)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id17">2.2 (2024-05-02)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id18">2.1 (2024-04-25)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id19">2.0 (2024-04-24)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id20">1.3 (2024-04-18)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id21">1.2 (2024-04-17)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id22">1.1 (2024-04-16)</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_history.html#id23">1.0 (2024-04-12)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#why-is-the-name-of-the-package-find-delay-when-installing-and-find-delay-when-importing">Why is the name of the package find-delay when installing, and find_delay when importing?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#i-want-to-use-find-delay-with-audio-files-but-my-audio-files-are-not-wav">I want to use find_delay with audio files, but my audio files are not WAV…</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-does-the-function-work-for-audio-files">How does the function work for audio files?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#the-delay-found-by-the-function-is-erroneous">The delay found by the function is erroneous…</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#i-found-an-issue-how-can-i-contact-the-developers">I found an issue! How can I contact the developers?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#i-have-an-idea-for-improvement">I have an idea for improvement!</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #99cc00" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">find_delay</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">find_delay</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/find_delay.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="find-delay">
<h1>find_delay<a class="headerlink" href="#find-delay" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="find_delay.find_delay">
<span class="sig-prename descclassname"><span class="pre">find_delay.</span></span><span class="sig-name descname"><span class="pre">find_delay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">array_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_array_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_array_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_envelope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_ratio_env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_below</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_over</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampling_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_ratio_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resampling_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_average_array_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_average_array_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_delay_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'index'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_none_if_below_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_correlation_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_delay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_intermediate_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_format_figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_figure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mono_channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_array_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Array</span> <span class="pre">1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_array_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Array</span> <span class="pre">2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dark_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_tabs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#find_delay.find_delay" title="Link to this definition"></a></dt>
<dd><p>This function tries to find the timestamp at which an excerpt (array_2) begins in a time series (array_1).
The computation is performed through cross-correlation. Before so, the envelopes of both arrays can first be
calculated and filtered (recommended for audio files), and resampled (necessary when the sampling rate of the two
arrays is unequal). The function returns the timestamp of the maximal correlation value, or <cite>None</cite> if this value is
below threshold. Optionally, it can also return a second element, the maximal correlation value.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.1: </span>Separated the figure generation into a new function <cite>_create_figure</cite>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0: </span>Changed parameters <cite>number_of_windows</cite> to <cite>window_size</cite>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1: </span>Decreased default <cite>window_size_res</cite> value from 1e8 to 1e7.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.3: </span>Corrected the figure saving to a file.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.4: </span>Modified the cross-correlation to look for the excerpt at the edges of the first array.
Added the new parameter <cite>x_format_figure</cite>, allowing to have HH:MM:SS times on the x-axis.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.9: </span>array_1 and array_2 can now be strings containing paths to WAV files.
Added the parameter mono_channel.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.13: </span>Added the parameters name_array_1 and name_array_2, allowing to customize the name of the arrays on the figure.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.15: </span>Added the parameters <cite>remove_average_array_1</cite> and <cite>remove_average_array_2</cite>, allowing to remove the average for
the corresponding arrays.
Added the parameter <cite>dark_mode</cite>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.17: </span>Added the parameters <cite>min_delay</cite> and <cite>max_delay</cite>, allowing to limit the search to a specific range of delays.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.18: </span>The parameter <cite>return_delay_format</cite> can now also take the value <code class="docutils literal notranslate"><span class="pre">&quot;sample&quot;</span></code>, which is an alias for <code class="docutils literal notranslate"><span class="pre">&quot;index&quot;</span></code>.
The parameter <cite>return_correlation_value</cite> can now accept the value <code class="docutils literal notranslate"><span class="pre">&quot;array&quot;</span></code>.
Added the parameter <cite>return_none_if_below_threshold</cite>.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Because it is easy to get confused: this function returns the timestamp in <code class="docutils literal notranslate"><span class="pre">array_1</span></code> where <code class="docutils literal notranslate"><span class="pre">array_2</span></code> begins.
This means that, if you want to align <code class="docutils literal notranslate"><span class="pre">array_1</span></code> and <code class="docutils literal notranslate"><span class="pre">array_2</span></code>, you need to remove the delay to each timestamp
of <code class="docutils literal notranslate"><span class="pre">array_1</span></code>: that way, the value at timestamp 0 in <code class="docutils literal notranslate"><span class="pre">array_1</span></code> will be aligned with the value at timestamp 0 in
<code class="docutils literal notranslate"><span class="pre">array_2</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since version 2.4, this function can find excerpts containing data that would be present outside the main array. In
other words, if the excerpt starts 1 second before the onset of the original array, the function will return a delay
of -1 sec. However, this should be avoided, as information missing from the original array will result in lower
correlation - with a substantial amount of data missing from the original array, the function may return erroneous
results. This is why <em>it is always preferable to use excerpts that are entirely contained in the original array</em>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array_1</strong> (<em>numpy.ndarray</em><em>|</em><em>list</em><em>|</em><em>str</em>) – <p>A first array of samples, or a string containing the path to a WAV file. In this case, the parameter
<cite>freq_array_1</cite> will be ignored and extracted from the WAV file. Note that if the WAV file contains more than one
channel, the function will turn the WAV to mono, using the method described by the parameter <cite>mono_channel</cite>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.9.</span></p>
</div>
</p></li>
<li><p><strong>array_2</strong> (<em>numpy.ndarray</em><em>|</em><em>list</em><em>|</em><em>str</em>) – <p>An second array of samples, smaller than or of equal size to the first one, that is allegedly an excerpt
from the first one. The amplitude, frequency or values do not have to match exactly the ones from the first
array. The parameter can also be a string containing the path to a WAV file (see description of parameter
<code class="docutils literal notranslate"><span class="pre">array_1</span></code>).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.9.</span></p>
</div>
</p></li>
<li><p><strong>freq_array_1</strong> (<em>int</em><em>|</em><em>float</em><em>, </em><em>optional</em>) – The sampling frequency of the first array, in Hz (default: 1). This parameter is ignored if array_1 is a path to
a WAV file.</p></li>
<li><p><strong>freq_array_2</strong> (<em>int</em><em>|</em><em>float</em><em>, </em><em>optional</em>) – The sampling frequency of the second array, in Hz (default: 1). This parameter is ignore is array_2 is a path to
a WAV file.</p></li>
<li><p><strong>compute_envelope</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <cite>True</cite> (default), calculates the envelope of the array values before performing the cross-correlation.</p></li>
<li><p><strong>window_size_env</strong> (<em>int</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – <p>The size of the windows in which to cut the arrays to calculate the envelope. Cutting long arrays
in windows allows to speed up the computation. If this parameter is set on <cite>None</cite>, the window size will be set
on the number of samples. A good value for this parameter is generally 1 million.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.</span></p>
</div>
</p></li>
<li><p><strong>overlap_ratio_env</strong> (<em>float</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – The ratio of samples overlapping between each window. If this parameter is not <cite>None</cite>, each window will
overlap with the previous (and, logically, the next) for an amount of samples equal to the number of samples in
a window times the overlap ratio. Then, only the central values of each window will be preserved and
concatenated; this allows to discard any “edge” effect due to the windowing. If the parameter is set on <cite>None</cite>
or 0, the windows will not overlap. By default, this parameter is set on 0.5, meaning that each
window will overlap for half of their values with the previous, and half of their values with the next.</p></li>
<li><p><strong>filter_below</strong> (<em>int</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – If set, a high-pass filter will be applied on the envelopes before performing the cross-correlation (default:
0 Hz).</p></li>
<li><p><strong>filter_over</strong> (<em>int</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – If set, a low-pass filter will be applied on the envelopes before performing the cross-correlation (default:
50 Hz).</p></li>
<li><p><strong>resampling_rate</strong> (<em>int</em><em>|</em><em>float</em><em>|</em><em>str</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – <p>The sampling rate at which to downsample the arrays for the cross-correlation. A larger value will result in
longer computation times.</p>
<ul>
<li><p>A recommended value for this parameter when working with audio files is 1000, as it will speed up the
computation of the cross-correlation while still giving a millisecond-precision delay.</p></li>
<li><p>Setting the parameter on <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> (default) will automatically downsample the array of higher frequency to
the frequency of the other.</p></li>
<li><p>Setting the parameter on <cite>None</cite> will not downsample the arrays, which will result in an error if the two
arrays are not the same frequency. If this parameter is <cite>None</cite>, the next parameters related to resampling can
be ignored.</p></li>
</ul>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.12.</span></p>
</div>
</p></li>
<li><p><strong>window_size_res</strong> (<em>int</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – <p>The size of the windows in which to cut the arrays. Cutting lo,g arrays in windows allows to speed up the
computation. If this parameter is set on <cite>None</cite>, the window size will be set on the number of samples. A good
value for this parameter is generally 1e7.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.1: </span>Decreased default <cite>window_size_res</cite> value from 1e8 to 1e7.</p>
</div>
</p></li>
<li><p><strong>overlap_ratio_res</strong> (<em>float</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – The ratio of samples overlapping between each window. If this parameter is not <cite>None</cite>, each window will
overlap with the previous (and, logically, the next) for an amount of samples equal to the number of samples in
a window times the overlap ratio. Then, only the central values of each window will be preserved and
concatenated; this allows to discard any “edge” effect due to the windowing. If the parameter is set on <cite>None</cite>
or 0, the windows will not overlap. By default, this parameter is set on 0.5, meaning that each window will
overlap for half of their values with the previous, and half of their values with the next.</p></li>
<li><p><strong>resampling_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>This parameter allows for various values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> performs a linear
<a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.interp.html">numpy.interp</a> interpolation. This method,
though simple, may not be very precise for upsampling naturalistic stimuli.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code> (default) performs a cubic interpolation via <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.CubicSpline.html">scipy.interpolate.CubicSpline</a>. This method,
while smoother than the linear interpolation, may lead to unwanted oscillations nearby strong variations in
the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;pchip&quot;</span></code> performs a monotonic cubic spline interpolation (Piecewise Cubic Hermite Interpolating
Polynomial) via <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.PchipInterpolator.html">scipy.interpolate.PchipInterpolator</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;akima&quot;</span></code> performs another type of monotonic cubic spline interpolation, using
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.Akima1DInterpolator.html">scipy.interpolate.Akima1DInterpolator</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;take&quot;</span></code> keeps one out of n samples from the original array. While being the fastest computation, it will
be prone to imprecision if the downsampling factor is not an integer divider of the original frequency.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;interp1d_XXX&quot;</span></code> uses the function <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.interp1d.html">scipy.interpolate.interp1d</a>. The XXX part of the
parameter can be replaced by <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nearest-up&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;zero&quot;</span></code>, “slinear”<code class="docutils literal notranslate"><span class="pre">,</span>
<span class="pre">``&quot;quadratic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;previous&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;next&quot;</span></code> (see the documentation of this function for
specifics).</p></li>
</ul>
</p></li>
<li><p><strong>remove_average_array_1</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>If set on <cite>True</cite>, removes the average value from all the values in <cite>array_1</cite>. A typical use-case for this
parameter is if an audio array is not centered around 0. Default: <cite>False</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.15.</span></p>
</div>
</p></li>
<li><p><strong>remove_average_array_2</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>If set on <cite>True</cite>, removes the average value from all the values in <cite>array_2</cite>. A typical use-case for this
parameter is if an audio array is not centered around 0. Default: <cite>False</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.15.</span></p>
</div>
</p></li>
<li><p><strong>return_delay_format</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>This parameter can be either <code class="docutils literal notranslate"><span class="pre">&quot;index&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ms&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;timedelta&quot;</span></code>:</p>
<blockquote>
<div><ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">&quot;index&quot;</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">&quot;sample&quot;</span></code>, the function will return the index in array_1 at which array_2
has the highest cross-correlation value.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">&quot;ms&quot;</span></code>, the function will return the timestamp in array_1, in milliseconds, at which array_2 has the
highest cross-correlation value.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code>, the function will return the timestamp in array_1, in seconds, at which array_2 has the
highest cross-correlation value.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">&quot;timedelta&quot;</span></code>, the function will return the timestamp in array_1 at which array_2 has the
highest cross-correlation value as a
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#timedelta-objects">datetime.timedelta</a> object.
Note that, in the case where the result is negative, the timedelta format may give unexpected display
results (-1 second returns -1 days, 86399 seconds).</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>return_none_if_below_threshold</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>If <cite>True</cite> (default), the function will return the value <cite>None</cite> if the correlation is below threshold (if
the parameter <cite>return_correlation_value</cite> is set on <cite>True</cite> or <code class="docutils literal notranslate"><span class="pre">&quot;array&quot;</span></code>, the two return values will be <cite>None</cite>).
If set on <cite>False</cite>, values are returned even if the correlation is below threshold.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.18.</span></p>
</div>
</p></li>
<li><p><strong>return_correlation_value</strong> (<em>bool</em><em>|</em><em>str optional</em>) – <p>If <cite>True</cite>, the function returns a second value: the correlation value at the returned delay. This value will
be None if it is below the specified threshold. If set on <code class="docutils literal notranslate"><span class="pre">&quot;array&quot;</span></code>, the second returned value will be a
two-dimensional array, where the first sub-array is the list of correlation values, and the second is their
corresponding timestamps or indices, depending on the value of <cite>return_delay_format</cite>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.18: </span>This parameter can now accept the value <code class="docutils literal notranslate"><span class="pre">&quot;array&quot;</span></code>.</p>
</div>
</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold of the minimum correlation value between the two arrays to accept a delay as a solution. If
multiple delays are over threshold, the delay with the maximum correlation value will be returned. This value
should be between 0 and 1; if the maximum found value is below the threshold, the function will return <cite>None</cite>
instead of a timestamp.</p></li>
<li><p><strong>min_delay</strong> (<em>int</em><em>|</em><em>float</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – The lower limit of the sample or time range in which to look for the highest correlation value. This parameter
must be specified in the same unit as <code class="docutils literal notranslate"><span class="pre">return_delay_format</span></code>.</p></li>
<li><p><strong>max_delay</strong> (<em>int</em><em>|</em><em>float</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – The upper limit of the sample or time range in which to look for the highest correlation value. This parameter
must be specified in the same unit as <code class="docutils literal notranslate"><span class="pre">return_delay_format</span></code>.</p></li>
<li><p><strong>plot_figure</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set on <cite>True</cite>, plots a graph showing the result of the cross-correlation using Matplotlib. Note that plotting
the figure causes an interruption of the code execution.</p></li>
<li><p><strong>plot_intermediate_steps</strong> (<em>bool</em><em>, </em><em>optional</em>) – If set on <cite>True</cite>, plots the original arrays, the envelopes (if calculated) and the resampled arrays (if
calculated) besides the cross-correlation.</p></li>
<li><p><strong>x_format_figure</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>If set on <cite>“time”</cite>, the values on the x axes of the output will take the HH:MM:SS format (or MM:SS if the time
series are less than one hour long). If set on <cite>“float”</cite>, the values on the x axes will be displayed as float
(unit: second). If set on <cite>“auto”</cite> (default), the format of the values on the x axes will be defined depending
on the value of <cite>return_delay_format</cite>.</p>
<blockquote>
<div><div class="versionadded">
<p><span class="versionmodified added">Added in version 2.4.</span></p>
</div>
</div></blockquote>
</p></li>
<li><p><strong>path_figure</strong> (<em>str</em><em>|</em><em>None</em><em>, </em><em>optional</em>) – If set, saves the figure at the given path.</p></li>
<li><p><strong>mono_channel</strong> (<em>int</em><em>|</em><em>str</em><em>, </em><em>optional</em>) – <p>Defines the method to use to convert multiple-channel WAV files to mono, if one of the parameters <cite>array1</cite> or
<cite>array2</cite> is a path pointing to a WAV file. By default, this parameter value is <code class="docutils literal notranslate"><span class="pre">0</span></code>: the channel with index 0
in the WAV file is used as the array, while all the other channels are discarded. This value can be any
of the channels indices (using <code class="docutils literal notranslate"><span class="pre">1</span></code> will preserve the channel with index 1, etc.). This parameter can also
take the value <code class="docutils literal notranslate"><span class="pre">&quot;average&quot;</span></code>: in that case, a new channel is created by averaging the values of all the
channels of the WAV file. Note that this parameter applies to both arrays: in the case where you need to select
different channels for each WAV file, open the files before calling the function and pass the samples and
frequencies as parameters.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.9.</span></p>
</div>
</p></li>
<li><p><strong>name_array_1</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>The name of the first array, as it will appear on the figure (default: “Array 1”).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.13.</span></p>
</div>
</p></li>
<li><p><strong>name_array_2</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>The name of the second array, as it will appear on the figure (default: “Array 2”).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.13.</span></p>
</div>
</p></li>
<li><p><strong>dark_mode</strong> (<em>bool</em><em>, </em><em>optional</em>) – <p>If set on <cite>True</cite>, uses the <a class="reference external" href="https://matplotlib.org/stable/gallery/style_sheets/dark_background.html">dark_background theme from matplotlib</a>
(default: <cite>False</cite>).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.15.</span></p>
</div>
</p></li>
<li><p><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em>) – <p>Sets how much feedback the code will provide in the console output:</p>
<ul>
<li><p><em>0: Silent mode.</em> The code won’t provide any feedback, apart from error messages.</p></li>
<li><p><em>1: Normal mode</em> (default). The code will provide essential feedback such as progression markers and
current steps.</p></li>
<li><p><em>2: Chatty mode.</em> The code will provide all possible information on the events happening. Note that this
may clutter the output and slow down the execution.</p></li>
</ul>
</p></li>
<li><p><strong>add_tabs</strong> (<em>int</em><em>, </em><em>optional</em>) – <p>Adds the specified amount of tabulations to the verbosity outputs (default: 0). This parameter may be used by
other functions to encapsulate the verbosity outputs by indenting them.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.12.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>int|float|timedelta|None</em> – The sample index, timestamp or timedelta of array_1 at which array_2 can be found (defined by the parameter
return_delay_format), or <cite>None</cite> if array1 is not contained in array_2.</p></li>
<li><p><em>float|None, optional</em> – Optionally, if return_correlation_value is <cite>True</cite>, the correlation value at the corresponding index/timestamp.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="find_delay documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="find_delays.html" class="btn btn-neutral float-right" title="find_delays" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Romain Pastureau.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>